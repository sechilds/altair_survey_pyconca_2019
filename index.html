<!doctype html>
<html>
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>reveal.js</title>

		<link rel="stylesheet" href="css/reset.css">
		<link rel="stylesheet" href="css/reveal.css">
		<link rel="stylesheet" href="css/theme/black.css">

		<!-- Theme used for syntax highlighting of code -->
		<link rel="stylesheet" href="lib/css/monokai.css">

		<!-- Printing and PDF exports -->
		<script>
			var link = document.createElement( 'link' );
			link.rel = 'stylesheet';
			link.type = 'text/css';
			link.href = window.location.search.match( /print-pdf/gi ) ? 'css/print/pdf.css' : 'css/print/paper.css';
			document.getElementsByTagName( 'head' )[0].appendChild( link );
		</script>
		<script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega@5"></script>
  		<script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega-lite@3.4.0"></script>
        <script type="text/javascript" src="https://cdn.jsdelivr.net/npm//vega-embed@4"></script>
	</head>
	<body>
		<style>
			.container{
				display: flex;
			}
			.col{
				flex: 1;
			}
		</style>

		<div class="reveal">
			<div class="slides">
				<section><h1>Data Visualization wtih Altair</h1>
					<h2>Survey Data Case Study</h2>
				</section>
				<section>
					<section>
						Context
					</section>
					<section>
						Pain/Problem
					</section>
					<section>
						Solution
					</section>
				</section>
				<section data-background-image="vari_flare.jpg">
					<aside class="notes">
						<p>I work at York University in the Office of
						Institutional Planning and Analysis (OIPA)
						where I survey students and analyze
						data from those surveys.</p>
					</aside>
				</section>
				<section>
					<section>
						<div id='interval_selection'></div>
					</section>
					<section>
						<div id='selection_histogram'></div>
					</section>
				</section>
				<section>
					<div id="anscombe_all"></div>
					<aside class="notes">
						Anscome's Quartet: All four of these datasets have the
						same mean of x and y as well as the same relationship
						between x and y.
					</aside>
				</section>
				<section>
					<section>
						<div id='big_bullseye'></div>
						<aside class="notes">
							All these datasets have the same mean of x and y.
						</aside>
					</section>
					<section>
						<div id='big_star'></div>
						<aside class="notes">
							All these datasets have the same mean of x and y.
						</aside>
					</section>
					<section>
						<div id='big_x_shape'></div>
						<aside class="notes">
							All these datasets have the same mean of x and y.
						</aside>
					</section>
					<section>
						<div id='big_dino1'></div>
						<aside class="notes">
							All these datasets have the same mean of x and y.
						</aside>
					</section>
					<section>
						<div id="datasaurus_all"</div>
						<aside class="notes">
							All these datasets have the same mean of x and y.
							This is all the datasets.
							Note the way we can facet the data.
						</aside>
					</section>
				</section>
				</section>
				<section>
				<section>
					<div class="container">
						<div class = "col">
					<pre><code class='python' data-trim>
(alt.Chart(datasaurus)
  .mark_point()
  .encode(
	x = 'x:Q',
	y = 'y:Q',
).transform_filter(
  alt.datum.dataset
    == 'dino')
)
					</code></pre>
						</div>
						<div class="col">
						<div id='small_dino1'></div>
						</div>
					</div>
					<aside class="notes">
						Altair follows the <em>Grammer of Graphics</em> approach.
						This goes back to Leland Wilkinson's 1999 book of the
						same name. There's a second edition in 2005.
						The book provides a framework for displaying graphics.
						Hadley Wickham used it for ggplot2 in the R world.
					</aside>
					</section>
				<section>
					<div class="container">
						<div class = "col">
					<pre><code class='python' data-trim data-noescape>
(alt.Chart(<mark>datasaurus</mark>)
  .mark_point()
  .encode(
	x = 'x:Q',
	y = 'y:Q',
).transform_filter(
  alt.datum.dataset
    == 'dino')
)
					</code></pre>
						</div>
						<div class="col">
						<div id='small_dino1_1'></div>
						</div>
					</div>
					<aside class="notes">
						Data
					</aside>
					</section>
				<section>
					<div class="container">
						<div class = "col">
					<pre><code class='python' data-trim data-noescape>
(alt.Chart(datasaurus)
  <mark>.mark_point()</mark>
  .encode(
	x = 'x:Q',
	y = 'y:Q',
).transform_filter(
  alt.datum.dataset
    == 'dino')
)
					</code></pre>
						</div>
						<div class="col">
						<div id='small_dino1_2'></div>
						</div>
					</div>
					<aside class="notes">
						Mark - area, bar, circle, geoshape, line, point, rect,
						rule, square, text, tick
					</aside>
					</section>
				<section>
					<div class="container">
						<div class = "col">
					<pre><code class='python' data-trim data-noescape>
(alt.Chart(datasaurus)
  .mark_point()
  .encode(
	<mark>x = 'x:Q',</mark>
	<mark>y = 'y:Q',</mark>
).transform_filter(
  alt.datum.dataset
    == 'dino')
)
					</code></pre>
						</div>
						<div class="col">
						<div id='small_dino1_3'></div>
						</div>
					</div>
					<aside class="notes">
						Encoding channels - x, y, colour, size, text,
						and more
					</aside>
					</section>
				<section>
					<div class="container">
						<div class = "col">
					<pre><code class='python' data-trim data-noescape>
(alt.Chart(datasaurus)
  .mark_point()
  .encode(
	x = 'x:Q',
	y = 'y:Q',
)<mark>.transform_filter(</mark>
 <mark> alt.datum.dataset</mark>
   <mark>== 'dino')</mark>
)
					</code></pre>
						</div>
						<div class="col">
						<div id='small_dino1_4'></div>
						</div>
					</div>
					<aside class="notes">
						Transformation. In this case filtering
						the dataset. There are lots of options for
						transforming data.
					</aside>
					</section>
					<section>
						Binning
					</section>
					<section>
						Means and other aggregations
					</section>
					<section>
						Facets
					</section>
					<section>
						Layers
						<aside class="notes">
							Mention interaction between facets
							and layers.
						</aside>
					</section>
				</section>
					<section>
						<pre><code class='python' data-trim>
uc = df.nunique().reset_index()
uc.columns = ['field', 'count']
alt.Chart(uc).mark_bar().encode(
	y='field:N',
	x='count:Q'
)
						</code></pre>
					</section>
					<section>
					<section>
						<table border="1" class="dataframe" style="font-size: 25px;">
							  <thead>
								<tr style="text-align: right;">
								  <th></th>
								  <th>id</th>
								  <th>satisfaction_v2</th>
								  <th>Gender</th>
								  <th>...</th>
								  <th>Online boarding</th>
								  <th>Departure Delay in Minutes</th>
								  <th>Arrival Delay in Minutes</th>
								</tr>
							  </thead>
							  <tbody>
								<tr>
								  <th>0</th>
								  <td>11112</td>
								  <td>satisfied</td>
								  <td>Female</td>
								  <td>...</td>
								  <td>2</td>
								  <td>0</td>
								  <td>0.0</td>
								</tr>
								<tr>
								  <th>1</th>
								  <td>110278</td>
								  <td>satisfied</td>
								  <td>Male</td>
								  <td>...</td>
								  <td>2</td>
								  <td>310</td>
								  <td>305.0</td>
								</tr>
								<tr>
								  <th>2</th>
								  <td>103199</td>
								  <td>satisfied</td>
								  <td>Female</td>
								  <td>...</td>
								  <td>2</td>
								  <td>0</td>
								  <td>0.0</td>
								</tr>
								<tr>
								  <th>3</th>
								  <td>47462</td>
								  <td>satisfied</td>
								  <td>Female</td>
								  <td>...</td>
								  <td>3</td>
								  <td>0</td>
								  <td>0.0</td>
								</tr>
								<tr>
								  <th>...</th>
								  <td>...</td>
								  <td>...</td>
								  <td>...</td>
								  <td>...</td>
								  <td>...</td>
								  <td>...</td>
								  <td>...</td>
								</tr>
								<tr>
								  <th>129876</th>
								  <td>97768</td>
								  <td>neutral or dissatisfied</td>
								  <td>Male</td>
								  <td>...</td>
								  <td>1</td>
								  <td>174</td>
								  <td>172.0</td>
								</tr>
								<tr>
								  <th>129877</th>
								  <td>125368</td>
								  <td>neutral or dissatisfied</td>
								  <td>Male</td>
								  <td>...</td>
								  <td>2</td>
								  <td>155</td>
								  <td>163.0</td>
								</tr>
								<tr>
								  <th>129878</th>
								  <td>251</td>
								  <td>neutral or dissatisfied</td>
								  <td>Male</td>
								  <td>...</td>
								  <td>2</td>
								  <td>193</td>
								  <td>205.0</td>
								</tr>
								<tr>
								  <th>129879</th>
								  <td>84566</td>
								  <td>neutral or dissatisfied</td>
								  <td>Female</td>
								  <td>...</td>
								  <td>3</td>
								  <td>185</td>
								  <td>186.0</td>
								</tr>
							  </tbody>
							</table>
							<aside class="notes">
								Survey data in it's raw form.
								Row are individual respondents.
								Columns are questions or characteritics of
								the respondent.
							</aside>
					</section>
					<section>
						<div id='unique_count1'>,/div>
					</section>
					<section>
						<pre><code class='python' data-trim>
alt.Chart(uc).mark_bar().encode(
	y='field:N',
	x='count:Q'
).transform_filter(alt.datum.count < 1000)
						</code></pre>
					</section>
					<section>
						<div id='unique_count2'></div>
					</section>
					<section>
						<div id='unique_count3'></div>
					</section>
					</section>
					<section>
					<section>
						<table border="1" class="dataframe" style="font-size: 25px;">
							  <thead>
								<tr style="text-align: right;">
								  <th></th>
								  <th>id</th>
								  <th>satisfaction_v2</th>
								  <th>Gender</th>
								  <th>...</th>
								  <th>Online boarding</th>
								  <th>Departure Delay in Minutes</th>
								  <th>Arrival Delay in Minutes</th>
								</tr>
							  </thead>
							  <tbody>
								<tr>
								  <th>0</th>
								  <td>11112</td>
								  <td>satisfied</td>
								  <td>Female</td>
								  <td>...</td>
								  <td>2</td>
								  <td>0</td>
								  <td>0.0</td>
								</tr>
								<tr>
								  <th>1</th>
								  <td>110278</td>
								  <td>satisfied</td>
								  <td>Male</td>
								  <td>...</td>
								  <td>2</td>
								  <td>310</td>
								  <td>305.0</td>
								</tr>
								<tr>
								  <th>2</th>
								  <td>103199</td>
								  <td>satisfied</td>
								  <td>Female</td>
								  <td>...</td>
								  <td>2</td>
								  <td>0</td>
								  <td>0.0</td>
								</tr>
								<tr>
								  <th>3</th>
								  <td>47462</td>
								  <td>satisfied</td>
								  <td>Female</td>
								  <td>...</td>
								  <td>3</td>
								  <td>0</td>
								  <td>0.0</td>
								</tr>
								<tr>
								  <th>...</th>
								  <td>...</td>
								  <td>...</td>
								  <td>...</td>
								  <td>...</td>
								  <td>...</td>
								  <td>...</td>
								  <td>...</td>
								</tr>
								<tr>
								  <th>129876</th>
								  <td>97768</td>
								  <td>neutral or dissatisfied</td>
								  <td>Male</td>
								  <td>...</td>
								  <td>1</td>
								  <td>174</td>
								  <td>172.0</td>
								</tr>
								<tr>
								  <th>129877</th>
								  <td>125368</td>
								  <td>neutral or dissatisfied</td>
								  <td>Male</td>
								  <td>...</td>
								  <td>2</td>
								  <td>155</td>
								  <td>163.0</td>
								</tr>
								<tr>
								  <th>129878</th>
								  <td>251</td>
								  <td>neutral or dissatisfied</td>
								  <td>Male</td>
								  <td>...</td>
								  <td>2</td>
								  <td>193</td>
								  <td>205.0</td>
								</tr>
								<tr>
								  <th>129879</th>
								  <td>84566</td>
								  <td>neutral or dissatisfied</td>
								  <td>Female</td>
								  <td>...</td>
								  <td>3</td>
								  <td>185</td>
								  <td>186.0</td>
								</tr>
							  </tbody>
							</table>
							<aside class="notes">
								Survey data in it's raw form.
								Row are individual respondents.
								Columns are questions or characteritics of
								the respondent.
							</aside>
					</section>
					<section>
						<pre><code class='python' data-trim data-noescape>
long_data = (df.set_index('id')
  <mark>.stack()</mark>
  .reset_index()
  .pipe(setcols,
     cols = ['id',
      'field_name',
      'response'])
  .set_index('id')
)
						</code></pre>
						<pre class = 'fragment'><code class='python' data-trim>
long_data = pd.merge(long_data,
  df,
  how = 'inner',
  left_index = True,
  right_index = True)
					 	</code></pre>
						<aside class="notes">
							We transform the data with <code>stack</code>.
							We merge in the original dataset so
							we now have all answers and characteristics
							available to fitler on.
						</aside>
					</section>
					<section>
							<table border="1" class="dataframe", style="font-size: 25px;">
							  <thead>
								<tr style="text-align: right;">
								  <th></th>
								  <th>id</th>
								  <th>field_name</th>
								  <th>response</th>
								  <th>...</th>
								  <th>Online boarding</th>
								  <th>Departure Delay in Minutes</th>
								  <th>Arrival Delay in Minutes</th>
								</tr>
							  </thead>
							  <tbody>
								<tr>
								  <th>0</th>
								  <td>1</td>
								  <td>Seat comfort</td>
								  <td>3</td>
								  <td>...</td>
								  <td>5</td>
								  <td>2</td>
								  <td>5.0</td>
								</tr>
								<tr>
								  <th>1</th>
								  <td>1</td>
								  <td>Departure/Arrival time convenient</td>
								  <td>3</td>
								  <td>...</td>
								  <td>5</td>
								  <td>2</td>
								  <td>5.0</td>
								</tr>
								<tr>
								  <th>2</th>
								  <td>1</td>
								  <td>Food and drink</td>
								  <td>3</td>
								  <td>...</td>
								  <td>5</td>
								  <td>2</td>
								  <td>5.0</td>
								</tr>
								<tr>
								  <th>3</th>
								  <td>1</td>
								  <td>Gate location</td>
								  <td>3</td>
								  <td>...</td>
								  <td>5</td>
								  <td>2</td>
								  <td>5.0</td>
								</tr>
								<tr>
								  <th>...</th>
								  <td>...</td>
								  <td>...</td>
								  <td>...</td>
								  <td>...</td>
								  <td>...</td>
								  <td>...</td>
								  <td>...</td>
								</tr>
								<tr>
								  <th>1818316</th>
								  <td>129880</td>
								  <td>Baggage handling</td>
								  <td>4</td>
								  <td>...</td>
								  <td>3</td>
								  <td>0</td>
								  <td>0.0</td>
								</tr>
								<tr>
								  <th>1818317</th>
								  <td>129880</td>
								  <td>Checkin service</td>
								  <td>5</td>
								  <td>...</td>
								  <td>3</td>
								  <td>0</td>
								  <td>0.0</td>
								</tr>
								<tr>
								  <th>1818318</th>
								  <td>129880</td>
								  <td>Cleanliness</td>
								  <td>4</td>
								  <td>...</td>
								  <td>3</td>
								  <td>0</td>
								  <td>0.0</td>
								</tr>
								<tr>
								  <th>1818319</th>
								  <td>129880</td>
								  <td>Online boarding</td>
								  <td>3</td>
								  <td>...</td>
								  <td>3</td>
								  <td>0</td>
								  <td>0.0</td>
								</tr>
							  </tbody>
							</table>
							<aside class = "notes">
								The transformed data. Note how the <code>id</code>
								field is repeated in multiple rows.
								Because we merged in the table -- we now
								have the same fields we had in the first table.
							</aside>
					</section>
					</section>

					<section>
						<div id='div_bar1'></div>
					</section>
					<section>
						<div id='div_bar2'></div>
					</section>
					<section>
						<div id='div_bar3'></div>
					</section>
					<section>
						<div id='div_bar4'></div>
					</section>
					<section>
						<div id='div_bar5'></div>
					</section>
					<section>
						<div id='div_bar6'></div>
					</section>
					<section>
						<div id='dashboard1'></div>
					</section>


			</div>
		</div>

		<script src="js/reveal.js"></script>

	<script type="text/javascript">
		var spec = 'big_dino1.json';
		var theme = {
			range: {
				category: {
					scheme: "dark2"
				}
			}
		};
		var opt = {theme: 'dark',
			       renderer: 'svg',
			       tooltip: false,
			       hover: false,
				   actions: false}
		var opt2 = {theme: 'dark',
			       renderer: 'svg',
			       tooltip: false,
			       hover: true,
				   actions: false}
vegaEmbed('#big_dino1', spec, opt).then(function(result) {}).catch(console.error);
	</script>

	<script type="text/javascript">
		var spec = 'big_away.json';
		vegaEmbed('#big_away', spec, opt).then(function(result) {}).catch(console.error);
	</script>

	<script type="text/javascript">
		var spec = 'big_bullseye.json';
		vegaEmbed('#big_bullseye', spec, opt).then(function(result) {}).catch(console.error);
	</script>

	<script type="text/javascript">
		var spec = 'big_circle.json';
		vegaEmbed('#big_circle', spec, opt).then(function(result) {}).catch(console.error);
	</script>

	<script type="text/javascript">
		var spec = 'big_dots.json';
		vegaEmbed('#big_dots', spec, opt).then(function(result) {}).catch(console.error);
	</script>

	<script type="text/javascript">
		var spec = 'big_h_lines.json';
		vegaEmbed('#big_h_lines', spec, opt).then(function(result) {}).catch(console.error);
	</script>

	<script type="text/javascript">
		var spec = 'big_high_lines.json';
		vegaEmbed('#big_high_lines', spec, opt).then(function(result) {}).catch(console.error);
	</script>

	<script type="text/javascript">
		var spec = 'big_slant_down.json';
		vegaEmbed('#big_slant_down', spec, opt).then(function(result) {}).catch(console.error);
	</script>

	<script type="text/javascript">
		var spec = 'big_slant_up.json';
		vegaEmbed('#big_slant_up', spec, opt).then(function(result) {}).catch(console.error);
	</script>

	<script type="text/javascript">
		var spec = 'big_star.json';
		vegaEmbed('#big_star', spec, opt).then(function(result) {}).catch(console.error);
	</script>

	<script type="text/javascript">
		var spec = 'big_v_lines.json';
		vegaEmbed('#big_v_lines', spec, opt).then(function(result) {}).catch(console.error);
	</script>

	<script type="text/javascript">
		var spec = 'big_wide_lines.json';
		vegaEmbed('#big_wide_lines', spec, opt).then(function(result) {}).catch(console.error);
	</script>

	<script type="text/javascript">
		var spec = 'big_x_shape.json';
		vegaEmbed('#big_x_shape', spec, opt).then(function(result) {}).catch(console.error);
	</script>

	<script type="text/javascript">
		var spec = 'small_dino1.json';
		vegaEmbed('#small_dino1', spec, opt).then(function(result) {}).catch(console.error);
	</script>
	<script type="text/javascript">
		var spec = 'small_dino1.json';
		vegaEmbed('#small_dino1_1', spec, opt).then(function(result) {}).catch(console.error);
	</script>

	<script type="text/javascript">
		var spec = 'small_dino1.json';
		vegaEmbed('#small_dino1_2', spec, opt).then(function(result) {}).catch(console.error);
	</script>
	<script type="text/javascript">
		var spec = 'small_dino1.json';
		vegaEmbed('#small_dino1_3', spec, opt).then(function(result) {}).catch(console.error);
	</script>
	<script type="text/javascript">
		var spec = 'small_dino1.json';
		vegaEmbed('#small_dino1_4', spec, opt).then(function(result) {}).catch(console.error);
	</script>
	<script type="text/javascript">
		var spec = 'anscombe_all.json';
		vegaEmbed('#anscombe_all', spec, opt).then(function(result) {}).catch(console.error);
	</script>

	<script type="text/javascript">
		var spec = 'datasaurus_all.json';
		vegaEmbed('#datasaurus_all', spec, opt).then(function(result) {}).catch(console.error);
	</script>

	<script type="text/javascript">
		var spec = 'unique_count1.json';
		vegaEmbed('#unique_count1', spec, opt).then(function(result) {}).catch(console.error);
	</script>
	<script type="text/javascript">
		var spec = 'unique_count2.json';
		vegaEmbed('#unique_count2', spec, opt).then(function(result) {}).catch(console.error);
	</script>
	<script type="text/javascript">
		var spec = 'unique_count3.json';
		vegaEmbed('#unique_count3', spec, opt).then(function(result) {}).catch(console.error);
	</script>
	<script type="text/javascript">
		var spec = 'div_bar1.json';
		vegaEmbed('#div_bar1', spec, opt).then(function(result) {}).catch(console.error);
	</script>
	<script type="text/javascript">
		var spec = 'div_bar2.json';
		vegaEmbed('#div_bar2', spec, opt).then(function(result) {}).catch(console.error);
	</script>
	<script type="text/javascript">
		var spec = 'div_bar3.json';
		vegaEmbed('#div_bar3', spec, opt).then(function(result) {}).catch(console.error);
	</script>
	<script type="text/javascript">
		var spec = 'div_bar4.json';
		vegaEmbed('#div_bar4', spec, opt).then(function(result) {}).catch(console.error);
	</script>
	<script type="text/javascript">
		var spec = 'div_bar5.json';
		vegaEmbed('#div_bar5', spec, opt).then(function(result) {}).catch(console.error);
	</script>
	<script type="text/javascript">
		var spec = 'div_bar6.json';
		vegaEmbed('#div_bar6', spec, opt).then(function(result) {}).catch(console.error);
	</script>
	<script type="text/javascript">
		var spec = 'interval_selection.json';
		vegaEmbed('#interval_selection', spec, opt2).then(function(result) {}).catch(console.error);
	</script>
	<script type="text/javascript">
		var spec = 'selection_histogram.json';
		vegaEmbed('#selection_histogram', spec, opt2).then(function(result) {}).catch(console.error);
	</script>
	<script type="text/javascript">
		var spec = 'dashboard1.json';
		vegaEmbed('#dashboard1', spec, opt2).then(function(result) {}).catch(console.error);
	</script>
		<script>
			// More info about config & dependencies:
			// - https://github.com/hakimel/reveal.js#configuration
			// - https://github.com/hakimel/reveal.js#dependencies
			Reveal.initialize({
				dependencies: [
					{ src: 'plugin/markdown/marked.js' },
					{ src: 'plugin/markdown/markdown.js' },
					{ src: 'plugin/notes/notes.js', async: true },
					{ src: 'plugin/highlight/highlight.js', async: true }
				]
			});
		</script>
	</body>
</html>
